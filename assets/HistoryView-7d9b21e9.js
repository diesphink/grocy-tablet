var x=(b,r,a)=>new Promise((m,o)=>{var d=s=>{try{u(a.next(s))}catch(n){o(n)}},f=s=>{try{u(a.throw(s))}catch(n){o(n)}},u=s=>s.done?m(s.value):Promise.resolve(s.value).then(d,f);u((a=a.apply(b,r)).next())});import{u as N,r as A,o as V,c as B,a as c,b as i,d as e,F as C,e as g,f as _,g as h,t as l,n as p,w as v,h as y,i as w,A as H,C as M,j as $}from"./index-bc8f6600.js";const z={class:"col-12"},D={class:"card"},I=e("div",{class:"card-header"},[e("h3",{class:"card-title"},"Histórico")],-1),L={class:"table-responsive"},E={class:"table card-table table-vcenter text-nowrap datatable"},F=e("thead",null,[e("tr",null,[e("th",null,"Produto"),e("th",null,"Quantidade"),e("th",null,"Data/Hora"),e("th",null,"Tipo"),e("th",null,"Local"),e("th",null,"Notas"),e("th",null,"Ações")])],-1),R={key:0},S={class:"text-danger"},T={class:"text-end"},U=["onClick"],j={class:"card-footer d-flex align-items-center"},G={class:"m-0 text-secondary"},P={class:"pagination m-0 ms-auto"},Q=["onClick"],K={__name:"HistoryView",setup(b){const r=N(),a=A(1),m=(s,n)=>Array.from({length:n-s+1},(t,k)=>s+k);V(()=>{o(1)});function o(s){a.value=s,r.fetchHistory(a.value)}const d=B(()=>r.history.length<50);function f(s){return x(this,null,function*(){yield r.undo_stock_log(s),o(a.value)})}function u(s){return s.charAt(0).toUpperCase()+s.slice(1)}return(s,n)=>(c(),i("div",z,[e("div",D,[I,e("div",L,[e("table",E,[F,e("tbody",null,[(c(!0),i(C,null,g(_(r).history,t=>(c(),i("tr",{key:t.id,class:p({undone:t.undone})},[e("td",null,l(t.product.name),1),e("td",null,l(t.amount),1),e("td",null,[h(l(u(t.row_created_timestamp.fromNow()))+" ",1),t.undone?(c(),i("div",R,[e("span",S,"(desfeito "+l(t.undone_timestamp.fromNow())+")",1)])):w("",!0)]),e("td",null,l(t.transaction_type),1),e("td",null,l(t.location.name),1),e("td",null,l(t.note),1),e("td",T,[t.undone?w("",!0):(c(),i("a",{key:0,href:"#",class:"btn btn-danger",onClick:v(k=>f(t.transaction_id),["prevent"])},[y(_(H),{class:"icon"}),h(" Desfazer ")],8,U))])],2))),128))])])]),e("div",j,[e("p",G,[h(" Exibindo de "),e("span",null,l((a.value-1)*50+1),1),h(" a "),e("span",null,l((a.value-1)*50+_(r).history.length),1)]),e("ul",P,[e("li",{class:p(["page-item",{disabled:a.value==1}])},[e("a",{class:"page-link",href:"#",tabindex:"-1","aria-disabled":"true",onClick:n[0]||(n[0]=v(t=>o(a.value-1),["prevent"]))},[y(_(M),{class:"icon"})])],2),(c(!0),i(C,null,g(m(Math.max(1,d.value?a.value-4:a.value-2),Math.max(5,d.value?a.value:a.value+2)),t=>(c(),i("li",{class:p(["page-item",{active:t==a.value}]),key:t},[e("a",{class:"page-link",href:"#",onClick:v(k=>o(t),["prevent"])},l(t),9,Q)],2))),128)),e("li",{class:p(["page-item",{disabled:d.value}])},[e("a",{class:"page-link",href:"#",onClick:n[1]||(n[1]=v(t=>o(a.value-1),["prevent"]))},[y(_($),{class:"icon"})])],2)])])])]))}};export{K as default};
