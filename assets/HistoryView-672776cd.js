var $=(k,r,n)=>new Promise((m,l)=>{var d=t=>{try{u(n.next(t))}catch(o){l(o)}},_=t=>{try{u(n.throw(t))}catch(o){l(o)}},u=t=>t.done?m(t.value):Promise.resolve(t.value).then(d,_);u((n=n.apply(k,r)).next())});import{u as M,r as N,o as V,c as A,a as i,b as c,d as e,t as s,F as b,e as g,f as h,n as v,w as p,g as y,h as C,i as w,A as B,C as H,j as L}from"./index-96a10fff.js";const I={class:"col-12"},T={class:"card"},z={class:"card-header"},F={class:"card-title"},R={class:"table-responsive"},S={class:"table card-table table-vcenter text-nowrap datatable"},U={key:0},j={class:"text-danger"},q={class:"text-end"},D=["onClick"],E={class:"card-footer d-flex align-items-center"},G=["innerHTML"],x={class:"pagination m-0 ms-auto"},J=["onClick"],P={__name:"HistoryView",setup(k){const r=M(),n=N(1),m=(t,o)=>Array.from({length:o-t+1},(a,f)=>t+f);V(()=>{l(1)});function l(t){n.value=t,r.fetchHistory(n.value)}const d=A(()=>r.history.length<50);function _(t){return $(this,null,function*(){yield r.undo_stock_log(t),l(n.value)})}function u(t){return t.charAt(0).toUpperCase()+t.slice(1)}return(t,o)=>(i(),c("div",I,[e("div",T,[e("div",z,[e("h3",F,s(t.$t("history")),1)]),e("div",R,[e("table",S,[e("thead",null,[e("tr",null,[e("th",null,s(t.$t("product")),1),e("th",null,s(t.$t("quantity")),1),e("th",null,s(t.$t("date-time")),1),e("th",null,s(t.$t("type")),1),e("th",null,s(t.$t("location")),1),e("th",null,s(t.$t("notes")),1),e("th",null,s(t.$t("actions")),1)])]),e("tbody",null,[(i(!0),c(b,null,g(h(r).history,a=>(i(),c("tr",{key:a.id,class:v({undone:a.undone})},[e("td",null,s(a.product.name),1),e("td",null,s(a.amount),1),e("td",null,[C(s(u(a.row_created_timestamp.fromNow()))+" ",1),a.undone?(i(),c("div",U,[e("span",j,s(t.$t("undone-at",[a.undone_timestamp.fromNow()])),1)])):w("",!0)]),e("td",null,s(a.transaction_type),1),e("td",null,s(a.location.name),1),e("td",null,s(a.note),1),e("td",q,[a.undone?w("",!0):(i(),c("a",{key:0,href:"#",class:"btn btn-danger",onClick:p(f=>_(a.transaction_id),["prevent"])},[y(h(B),{class:"icon"}),C(" "+s(t.$t("undo")),1)],8,D))])],2))),128))])])]),e("div",E,[e("p",{class:"m-0 text-secondary",innerHTML:t.$t("showing-from-to",{from:(n.value-1)*50+1,to:(n.value-1)*50+h(r).history.length})},null,8,G),e("ul",x,[e("li",{class:v(["page-item",{disabled:n.value==1}])},[e("a",{class:"page-link",href:"#",tabindex:"-1","aria-disabled":"true",onClick:o[0]||(o[0]=p(a=>l(n.value-1),["prevent"]))},[y(h(H),{class:"icon"})])],2),(i(!0),c(b,null,g(m(Math.max(1,d.value?n.value-4:n.value-2),Math.max(5,d.value?n.value:n.value+2)),a=>(i(),c("li",{class:v(["page-item",{active:a==n.value}]),key:a},[e("a",{class:"page-link",href:"#",onClick:p(f=>l(a),["prevent"])},s(a),9,J)],2))),128)),e("li",{class:v(["page-item",{disabled:d.value}])},[e("a",{class:"page-link",href:"#",onClick:o[1]||(o[1]=p(a=>l(n.value-1),["prevent"]))},[y(h(L),{class:"icon"})])],2)])])])]))}};export{P as default};
